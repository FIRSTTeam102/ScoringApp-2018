//-
	Index/homepage. Provides links to tournament details. If a user isn't logged in, then includes login links.
	PARAM
		res.locals.user		[Object] {name, subteam, assigned, ...} If user is logged in, object exists. If not, null.
	CALLED FROM
		index.js	'/'
	//
extends layout
block content
	h6(class="gear-text-white") 
		i Click the top graphic on any page to get back to this home page!
	p
	div(class="w3-container w3-section")
		h4(class="gear-text-white") Tournament Info
		
		a(href="/reports/rankings")
			div(class="gear-btn gear-orange gear-hover-white w3-btn")
				span Current Rankings
		br 
		a(href="/reports/finishedmatches")
			div(class="gear-btn gear-orange gear-hover-white w3-btn")
				span Completed Matches [All teams]
		br 
		a(href="/reports/metrics")
			div(class="gear-btn gear-orange gear-hover-white w3-btn")
				span Statistics
	div(class="w3-container w3-section")
		h4(class="gear-text-white") Team Info
		//teamSelect dropdown for intel and upcoming pages.
		if( teamList && teamList[0] )
			label(class="")
				select#teamSelect(class="gear-btn gear-orange w3-btn")
					option(value="") Team #
					each team in teamList
						option(value=team class="w3-bar-item") #{team}
		//-
			label(style="position:relative;top:8px")
				input(class="w3-padding gear-orange w3-border-white w3-border w3-margin-right" style="border: none; width: 6.2em" type="number" placeholder="Team #" id="teamNo")
			//
		a
			button(class="gear-btn gear-orange w3-btn w3-disabled" onclick="redIntel()" id="stats" disabled)
				span Stats
		a
			div(class="gear-btn gear-orange gear-hover-white w3-btn" onclick="redUpcoming()")
				span Upcoming Matches [Team or All]
	//Login if not logged in
	if( !user || (user && user.name == "[Dev]"))
		div(class="w3-container w3-section")
			h4(class="gear-text-white") Team 102 Log In
			a(href="/login/scouter") 
				div(class="gear-btn gear-orange gear-hover-white w3-btn")
					span Scouter Login
			br 
			a(href="/login/admin")
				div(class="gear-btn gear-orange gear-hover-white w3-btn")
					span Admin Login
	if user
		div(class="w3-container w3-section")
			h4(class="gear-text-white")=user.name
			a(href="/dashboard")
				div(class="gear-btn gear-orange gear-hover-white w3-btn") Dashboard
			if( user.subteam == "support" || user.subteam == "exec" )
				a(href="/admin")
					div(class="gear-btn gear-orange gear-hover-white w3-btn") Admin Index
	script.
		//Checks if teamSelect/teamNo are filled, and if so, redirect the user to intel.
		function redIntel(){
			if( !$("#teamSelect").val() ){
				if( !!$("#teamNo").val()) {
					//if teamSelect is filled, proceed to intel url
					var key = "frc".concat($("#teamNo").val());
					console.log("/reports/teamintel?team="+key);
					window.location.href = "/reports/teamintel?team="+key;
				
				}else if( !$("#stats").prop("disabled"))
					//if nothing selected then do alert thang
					alert("You must specify a team.");
			}else{
				//if text input is filled, proceed to intel url
				var key = "frc".concat($("#teamSelect").val());
				console.log("/reports/teamintel?team="+key);
				window.location.href = "/reports/teamintel?team="+key;
			}
		}
		//Checks if teamSelect/teamNo are filled; and if so, redirect user to upcoming page.
		function redUpcoming(){
			if( !$("#teamNo").val() && !$("#teamSelect").val() ){
				window.location.href = "/reports/upcoming";
			}else{
				if(!!$("#teamSelect").val){
					var key = "frc".concat($("#teamSelect").val());
					window.location.href = "/reports/upcoming?team="+key;
				}else{
					var key = "frc".concat($("#teamNo").val());
					window.location.href = "/reports/upcoming?team="+key;
				}
			}
		}
		$("#teamNo").keyup(function(e){
			setTimeout( isTeamFilled(this), 1);
			if(e.keyCode == 13){
				redIntel();
			}
		});
		$("#teamNo").click(function(e){
			setTimeout( isTeamFilled(this), 1);
		});
		$("#teamSelect").on("change", function(e){
			setTimeout( isTeamFilled(this), 1);
		});
		function isTeamFilled(teamNo){
			//console.log(teamNo);
			console.log(teamNo.value);
			if( teamNo.value != ""){
				$("#stats").addClass("gear-hover-white");
				$("#stats").removeClass("w3-disabled");
				$("#stats").prop("disabled", false);
			}else{
				$("#stats").removeClass("gear-hover-white");
				$("#stats").addClass("w3-disabled");
				$("#stats").prop("disabled", true);
			}
		}