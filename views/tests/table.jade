extends ../layout

block content
	table(class="table")
		th programming
		th mechanical
		th electrical
		tr
			td
				ul(class="list-group")
					each member, i in prog
						li(class="list-group-item")
							button(class='btn btn-block' chosenstate='false' id='#{member.name}' onclick='toggle("#{member.name}")')= member.name
			td
				ul(class="list-group")
					each member, i in mech
						li(class="list-group-item")
							button(class='btn btn-block' chosenstate='false' id='#{member.name}' onclick='toggle("#{member.name}")')= member.name
			td
				ul(class="list-group")
					each member, i in elec
						li(class="list-group-item")
							button(class='btn btn-block' chosenstate='false' id='#{member.name}' onclick='toggle("#{member.name}")')= member.name
	form#setmemberpair(name="setmemberpair",method="post",action="/tests/setmemberpair")
		input#setmemberpairdata(type="hidden", name="data")
	button(class="btn btn-info btn-block" onclick="submitPair()") Submit selected members as a new scouting group

	if assigned.length > 0
		hr
		h2 Assigned pairs
	ul
		each pair in assigned
			li
				- var selectedArray = [];
				- var pairId;
				- for (var key in pair) if (key != "_id") selectedArray.push(key);
				- for (var key in pair) if (key == "_id") pairId=pair[key];
				- thisButtonLabel = selectedArray.toString();
				button(onclick='delete("#{pairId}")') Delete pair
				|    #{thisButtonLabel}
	
	script.
		var selectedDict = {};
	
		function toggle(id)
		{
			console.log(id);
			var currentstate = document.getElementById(id).getAttribute("chosenstate");
			console.log(currentstate);
			if (currentstate == "false")
			{
				document.getElementById(id).className = "btn btn-success btn-block";
				document.getElementById(id).setAttribute("chosenstate", "true");
				selectedDict[id] = id;
			}
			else
			{
				document.getElementById(id).className = "btn btn-block";
				document.getElementById(id).setAttribute("chosenstate", "false");
				delete selectedDict[id];
			}
		}
		
		function submitPair()
		{
			console.log(selectedArray);
			var selectedArray = [];
			for (var key in selectedDict)
			{
				selectedArray.push(selectedDict[key]);
			}
			console.log(selectedArray.toString());
			//document.getElementById("selectedString").innerHTML = selectedArray.toString();
			document.getElementById("setmemberpairdata").value = JSON.stringify(selectedDict);
			
			document.getElementById("setmemberpair").submit();
		}
		
	div(id="selectedString")
